more functions for nested loop
